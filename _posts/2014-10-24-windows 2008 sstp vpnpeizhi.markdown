---
layout: post
title:  "Windows 2008 sstp vpn配置"
date:   2014/10/24 11:35:00
categories: windows2008server vpn sstp
---
<p><h2>服务端： </h2> <p>首先，在windows 2008服务器上添加网络策略和访问服务的角色 <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_2.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb.png" width="244" height="182"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_4.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_1.png" width="244" height="181"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_6.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_2.png" width="244" height="181"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_8.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_3.png" width="244" height="182"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_10.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_4.png" width="244" height="183"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_12.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_5.png" width="244" height="181"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_14.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_6.png" width="244" height="183"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_16.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_7.png" width="244" height="181"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_18.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_8.png" width="244" height="178"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_20.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_9.png" width="244" height="182"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_22.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_10.png" width="244" height="183"></a> <p>安装成功后，在服务器管理中展开角色，按照下图配置并启用路由和远程访问 <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_24.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_11.png" width="244" height="150"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_26.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_12.png" width="244" height="187"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_28.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_13.png" width="244" height="186"></a> <p>启用成功后 <p>需要将服务端证书copy到客户端 <p>按照如下步骤将服务端证书导出 <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_30.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_14.png" width="244" height="131"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_32.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_15.png" width="244" height="155"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_34.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_16.png" width="244" height="143"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_36.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_17.png" width="244" height="206"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_38.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_18.png" width="244" height="198"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_40.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_19.png" width="244" height="102"></a> <p>导出后，桌面上就会有sstpvpn.p7b的证书，将证书复制到客户端 <p>然后创建名为sstpvpn的账户 <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_42.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_20.png" width="244" height="176"></a> <p>开启其网络访问权限 <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_44.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_21.png" width="218" height="244"></a> <p>服务端设置完毕 <h2>客户端（windows7及其以后的windows系统）：</h2> <p>先导入证书sstpvpn.p7b <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_46.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_22.png" width="244" height="128"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_48.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_23.png" width="244" height="127"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_50.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_24.png" width="244" height="170"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_52.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_25.png" width="244" height="189"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_54.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_26.png" width="244" height="189"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_56.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_27.png" width="244" height="127"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_58.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_28.png" width="244" height="229"></a> <p>然后在C:\WINDOWS\SYSTEM32\Driver\etc\hosts中配置如下信息 <p>182.254.231.191（服务器外网IP） 10_249_164_110（证书CN名） <p>设置客户端vpn连接 <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_60.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_29.png" width="244" height="180"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_62.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_30.png" width="244" height="181"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_64.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_31.png" width="244" height="181"></a> <p>在连接属性中进行如下设置 <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_66.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_32.png" width="195" height="244"></a> <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_68.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_33.png" width="244" height="152"></a> <p>去掉在远程网络上使用默认网关 <p><a href="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_70.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="http://francisar.github.io/images/2014-10-23/Windows-Live-Writer_da5fe0a23645_14A23_image_thumb_34.png" width="209" height="244"></a> <p>现在就可以通过刚刚创建的vpn连接来远程连接服务器了，用户名密码就是刚刚创建的sstpvpn账户 